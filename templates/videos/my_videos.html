{% extends 'base.html' %}
{% load core_tags %}

{% block title %}Мои видео - TubeCMS{% endblock %}

{% block content %}
<div class="my-videos-container">
    <div class="my-videos-header">
        <h1>Мои видео</h1>
        <a href="{% url 'videos:upload' %}" class="btn btn-primary">
            <i class="fas fa-plus"></i>
            Загрузить видео
        </a>
    </div>
    
    <div class="my-videos-content">
        {% if videos %}
            <div class="video-grid">
                {% for video in videos %}
                    <div class="video-card">
                        <a href="{% url 'videos:detail' video.slug %}">
                            <div class="thumbnail">
                                {% if video.preview %}
                                    <video src="{{ video.preview.url }}" alt="{{ video.title }}" loading="lazy" muted>
                                {% else %}
                                    <div style="background: linear-gradient(45deg, #ff0000, #ff8c00); height: 100%;"></div>
                                {% endif %}
                                <span class="duration">{{ video.duration|format_duration }}</span>
                                {% if video.status == 'processing' %}
                                    <div class="processing-overlay">
                                        <i class="fas fa-cog fa-spin"></i>
                                        <span>Обработка...</span>
                                    </div>
                                {% elif video.status == 'draft' %}
                                    <div class="draft-overlay">
                                        <i class="fas fa-edit"></i>
                                        <span>Черновик</span>
                                    </div>
                                {% endif %}
                            </div>
                        </a>
                        <div class="video-info">
                            <div class="video-details">
                                <div class="video-title">{{ video.title|truncate_text:50 }}</div>
                                <div class="video-meta">
                                    <span>{{ video.views_count|format_views }} просмотров</span>
                                    <span>{{ video.created_at|time_ago }}</span>
                                </div>
                                <div class="video-status">
                                    <span class="status-badge status-{{ video.status }}">
                                        {% if video.status == 'published' %}Опубликовано
                                        {% elif video.status == 'draft' %}Черновик
                                        {% elif video.status == 'processing' %}Обработка
                                        {% elif video.status == 'private' %}Приватное
                                        {% else %}{{ video.get_status_display }}
                                        {% endif %}
                                    </span>
                                </div>
                            </div>
                            <div class="video-actions">
                                <a href="{% url 'videos:edit' video.slug %}" class="action-btn edit-btn" title="Редактировать">
                                    <i class="fas fa-edit"></i>
                                </a>
                                <a href="{% url 'videos:delete' video.slug %}" class="action-btn delete-btn" title="Удалить" onclick="return confirm('Удалить видео?')">
                                    <i class="fas fa-trash"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
            
            {% if videos.has_other_pages %}
                {% include 'partials/pagination.html' %}
            {% endif %}
        {% else %}
            <div class="no-content">
                <i class="fas fa-video"></i>
                <h3>У вас пока нет видео</h3>
                <p>Загрузите свое первое видео и поделитесь им с миром!</p>
                <a href="{% url 'videos:upload' %}" class="btn btn-primary">Загрузить видео</a>
            </div>
        {% endif %}
    </div>
</div>

{% endblock %}

